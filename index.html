<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  script-src 'self' https://accounts.google.com https://apis.google.com https://www.gstatic.com 'unsafe-inline' 'unsafe-eval';
">
  <title>Budget Tracker</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
  <script async defer src="https://accounts.google.com/gsi/client"></script>
  <!-- Google API client (fires window.onGapiLoad when ready) -->
  <script async defer src="https://apis.google.com/js/api.js?onload=onGapiLoad"></script>
</head>

<body>
  <div id="app">
    <h1>Budget Tracker</h1>
    <form id="entryForm">
      <label>Date & Time: <input type="datetime-local" id="datetime" required></label>

      <label>Account:
        <select id="account">
          <option value="Wallet">Wallet</option>
          <option value="Bank - Frimi">Bank - Frimi</option>
          <option value="Bank - NSB">Bank - NSB</option>
          <option value="Bank - Commercial">Bank - Commercial</option>
        </select>
      </label>

      <label>Category:
        <select id="category">
          <option value="Prior savings">Prior savings</option>
          <option value="Expenses">Expenses</option>
          <option value="Banking">Banking</option>
        </select>
      </label>

      <label>Subcategory:
        <input type="text" id="subcategory">
      </label>

      <label>Note:
        <input type="text" id="note">
      </label>

      <label>Description:
        <input type="text" id="description">
      </label>

      <label>Type:
        <select id="type">
          <option value="Income">Income</option>
          <option value="Expense">Expense</option>
        </select>
      </label>

      <label>Amount (LKR):
        <input type="number" id="amount" step="0.01" required>
      </label>

      <button type="submit" id="submitBtn">Add</button>
    </form>
    <!-- Backup button -->
    <button id="backupBtn">Backup to Drive</button>
    <span id="backupStatus"></span>
    <button id="restoreBtn">Restore from Drive</button>
    <span id="restoreStatus"></span>
    <!-- export -->
    <button onclick="exportEntries('csv')">Export CSV</button>
    <button onclick="exportEntries('tsv')">Export TSV</button>
    <!-- import -->
    <input type="file" id="importFile" accept=".csv,.tsv">
    <ul id="entries"></ul>
  </div>
  <!-- correct Umbrella.js import -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/umbrella/3.0.0/umbrella.min.js"></script>
  <script src="app.js"></script>
</body>

</html>